from john kelsey subject re implementing a diffie-hellman key exchange you should probably use number much larger than also you may want to include some randomly-generated bitstring in ymy protocol thi way if someone should find the share key you and another person use on one day they wo be able to gues it for the next day ie a send mod p and random string b send mod p and random string both find mod p b mod p shared key then both calculate session key hash shared key also you will want to make sure that you get the right public key value mod p someone with the power to intercept and change message can oterwise spoof you by send both of you hi public key and then acquire a session key with each of you john 