from einkauf mark einkauf subject re need help z-buffering line area together david gorgen write i ask for help on a sticky problem involve unreasonably low apparent precision in z-buffering that i encounter in different pex implementation i ca find any discussion of thi problem in any resource i can lay hand on the faq gaskin vendor documentation the problem to be solve be to eliminate or minimize stitch artifact result from the use of z-buffering with polyline that be coplanar with fill area the interpolate z value along a line will differ slightly due to roundoff error from the interpolate z value acros an area even when the endpoint of the line be coincident with vertex of the area because of thi it a tossup whether the z-buffer will allow the line pixel or the area pixel to be display visually the result tend to be a dashed-line effect even though the line be suppose to be solid using the pexlib apus my approach to a solution be to use two slightly different pex view map transform in two view table entry one for the area and one for the line the pex structure or immediate mode output must be organize so that one view table index be alway in effect for area and the other be alway in effect for line the result be a slight shift in npc z coordinate for the line so a to attempt to bia the tossup situation in favor of the line thi shift be effect by move the front and back clip plane use in the pexlib view table entry for line just a hair backward smaller vrc z coordinate compare to their position in the view table entry use for area thi mean that when a point be transform to npc it z value will be slightly bigger if it come from a line than if it come from an area thu accomplish the desire bia i would expect the z roundoff error which cause the problem to amount to a few unit at most out of the entire dynamic range of the z-buffer typically from to if not or bite z-buffer therefore it seem that a tiny fraction of the range of z in vrc between the front and back clip plane ought to suffice to reliably fix the stitch but in fact experience show that the shift ha to be a much a to of the range empirically it worst when the npc z component of the slope of the surface be high when it appear more or le edge-on to the viewer it a if only or bite of the z-buffer have any dependable mean thi amount be so great that one problem be replace by another sometime the polyline show through area which they be suppose to lie behind i observe the problem on both hewlett-packard and digital workstation pex server to approximately the same degree the test program demonstrate the problem on an mit pexlib implementation thi version be know to compile and run on an hp-ux system with pex open question why do thi happen am i configure the pex view table wrongly is there a systematic difference in z interpolation for line a oppose to area pixel center versu corner which could be correct for are pex implementor wantonly discard z precision in their interpolator something else what to do about it can i fix my use of the view table to allow better precision in z-buffered hlhsr is there another approach i can take to remove the stitch artifact am i just out of luck we here at ibm have the same problem with my workstation i wa also shock when i first realize that you have to offset line from fill by about bite assume bite z buffer thi seem huge but be only of the dynamic range in those term it do seem so bad what be happen be that the interpolation in z be not totally linear due mainly to roundoff i believe so the polygon be not planar in z but be more like a ruffle potato chip ditto with line when you at different value the ridge be out of phase result in the stitch effect you have the same problem if you try to draw polygon right on top of another but with different vertex you will likely see a smear effect where they overlap example try polygon polygon ymy implementation be correct in fact we do a similar trick when render primitive that have line and polygon such a nurb surface with isoparametric line without the trick the line appear stitch a you say when the application draw independently the system do not have the smart to automatically do the z shift so the application must do it thi be what you have discover and be do bravo note to the information give here ha be previously disclose through proper channel so i not give away any new unpublished info mark einkauf einkauf ibm advanced workstation and system graphic system austin tx view and opinion express herein be not necessarily those of ibm corp 