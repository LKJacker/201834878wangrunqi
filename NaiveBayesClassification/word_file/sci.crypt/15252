from crypt-comment subject cryptography faq product cipher archive-name last-modified faq for part product cipher thi be the fifth of ten part of the faq the part be mostly independent but you should read the first part before the rest we do have the time to send out miss part by mail so do ask note such a refer to the reference list in the last part the section of thi faq be available vium anonymou ftp to a xx the cryptography faq be post to the newsgroup and every day content what be a product cipher what make a product cipher secure what be some group-theoretic property of product cipher what can be prove about the security of a product cipher how be block cipher use to encrypt datum longer than the block size can symmetric block cipher be use for message authentication what exactly be de what be triple de what be differential cryptanalysi how wa nsa involve in the design of de is de available in software is de available in hardware can de be use to protect classify information what be ecb cbc cfb and ofb encryption what be a product cipher a product cipher be a block cipher that iterate several weak operation such a substitution transposition modular and linear transformation a block cipher just mean a cipher that encrypt a block of datum byte say all at once then go on to the next block the notion of product cipher be due to shannon example of modern product cipher include lucifer de sp-network loki feal pes khufu and khafre the so-called feistel cipher be a clas of product cipher which operate on one half of the ciphertext at each round and then swap the ciphertext half after each round lucifer de loki and feal be example of feistel cipher the follow table compare the main parameter of several product cipher cipher block length key bite number of round lucifer de loki feal x pes what make a product cipher secure nobody know how to prove mathematically that a product cipher be completely secure so in practice one begin by demonstrate that the cipher look highly random for example the cipher must be nonlinear and it must produce ciphertext which functionally depend on every bite of the plaintext and the key meyer ha show that at least round of de be require to guarantee such a dependence in thi sense a product cipher should act a a mix function which combine the plaintext key and ciphertext in a complex nonlinear fashion the fix per-round substitution of the product cipher be refer to a s-box for example lucifer ha s-box and de ha s-box the nonlinearity of a product cipher reduce to a careful design of these s-box a list of partial design criterium for the s-box of de which apply to s-box in general may be find in brown and brickell et al what be some group-theoretic property of product cipher let e be a product cipher that map n-bit block to n-bit block let x be the encryption of x under key k then for any fix k the map send x to x be a permutation of the set of n-bit block denote thi permutation by the set of all n-bit permutation be call the symmetric group and be write s the collection of all these permutation where k range over all possible key be denote e s if e be a random map from plaintext to ciphertext then we would expect e s to generate a large subset of s coppersmith and grossman have show that a very simple product cipher can generate the alternate group a give a sufficient number of round the alternate group be half of the symmetric group it consist of all even permutation all permutation which can be write a an even number of swap even and goldreich be able to extend these result to show that feistel cipher can generate a give a sufficient number of round the security of multiple encipherment also depend on the group-theoretic property of a cipher multiple encipherment be an extension over single encipherment if for key there do not exist a third key such that x e x which indicate that encrypt twice with two independent key be equal to a single encryption under the third key if for every there exist a such that eq be true then we say that e be a group thi question of whether de be a group under thi definition wa extensively study by sherman kaliski and rivest in their paper they give strong evidence for the hypothesi that de be not a group in fact de be not a group what can be prove about the security of a product cipher recall from above that be a permutation produce by e under some key k the goal of the designer of e be to ensure that appear to be a random element of s the symmetric group let r be an element of s select randomly we will say that and r be indistinguishable if an observer give and r in some order can not distinguish between these two permutation in polynomial time that be with time bound resource the observer can not determine which of the permutation be produce by e the optimal decision be no better than simply guess luby and rackoff have show that a clas of feistel cipher be secure in thi sense when the round map be replace by random boolean function how be block cipher use to encrypt datum longer than the block size there be fmy standard mode of operation and numerou non-standard one a well the standard mode of operation be define in the department of commerce federal information processing standard fip publish in see the question about ecb below for more detail although they be define for the de block cipher the mode of operation can be use with any block cipher can symmetric block cipher be use for message authentication one may use a symmetric cryptosystem block cipher to prove to himself that he do or do not generate a message and to prove to himself whether hi message wa alter or unaltered since generation but one can not prove these thing to another without reveal the key and thereafter that key can not be use to prove anything about any message that be authenticate use that key see ansi and fip for a standard method of message authentication use de what exactly be de de be the government datum encryption standard a product cipher that operate on block of datum use a key it be define in fip which supersede fip fip be federal information processing standard publish by nti de be identical to the ansi standard datum encryption algorithm dea define in ansi what be triple de triple de be a product cipher which like de operate on datum block there be several form each of which use the de cipher time some form use two key some use three the de mode of operation may also be use with triple-de some person refer to e d e x a triple-de thi method be define in chapter of the ansi standard financial institution key management and be intend for use in encrypt de key and iv for automated key distribution it formal name be encryption and decryption of a single key by a key pair but it be reference in other standard document a ede that standard say section key encrypt key may be a single dea key or a dea key pair key pair shoud be use where additional security be need the datum protect by the key s ha a long security life a key pair shall not be encrypt or decrypt use a single key other use the term triple-de for e d e x or e e e x one of u carl ellison keep advocate de triple use in the form e tran e tran e compres x where each de instance ha it own key and iv for cbc mode and tran ha be post on it be a large-block transposition program take it key from the datum stream itself so that it be not an encryption program on it own part what be differential cryptanalysi differential cryptanalysi be a statistical attack that can be apply to any iterate map ie any map which be base on a repeat round function the method wa recently popularize by biham and shamir but coppersmith ha remark that the s-box of de be optimize against thi attack some year ago thi method ha prove effective against several product cipher notably feal differential cryptanalysi be base on observe a large number of ciphertext y y whose correspond plaintext x x satisfy a know difference d where be componentwise xor in the basic biham-shamir attack such plaintext pair be require to determine the key for de substantially fewer pair be require if de be truncate to or round in these case the actual key can be recover in a matter of minute use a few thousand pair for full de thi attack be impractical because it require so many know plaintext the work of biham and shamir on de reveal several startle observation on the algorithm most importantly if the key schedule wa remove from de and a key wa use the key could be recover in le than step thu independent subkey do not add substantial security to de further the s-box of de be extremely sensitive in that change even single entry in these table yield significant improvement in the differential attack adi shamir be quote to say nytime oct i would say that contrary to what some person believe there be no evidence of tamper with the de so that the basic design wa weaken how wa nsa involve in the design of de according to kinnucan tuchman a member of the group that develop de at ibm be quote a say we develop the de algorithm entirely within ibm use ibmer the nsa do not dictate a single wire tuchman and meyer another developer of de spend a year break cipher and find weakness in lucifer they then spend two year strengthen lucifer their basic approach wa to look for strong substitution permutation and key schedule function ibm ha classify the note contain the selection criterium at the request of the nsa the nsa tell u we have inadvertently reinvent some of the deep secret it use to make it own algorithm explain tuchman on the other hand a document call involvement of the nsa in the development of de unclassified summary of the united state select committee on intelligence print in the ieee communication magazine state in the development of de nsa convince ibm that a reduce keysize wa sufficient indirectly assist in the development of the s-box structure and certify that the final de algorithm wa to the best of their knowledge free from any statistical or mathematical weaknes clearly the key size wa reduce at the insistence of the nsa the article further state that the nsa do not tamper with the algorithm itself just the parameter which in some sense resolf the apparent conflict in the remark of meyer and tuchman present above is de available in software several person have make de code available vium ftp see part for pathname stig ostholm ftpso bsd ftpbk eric young ftpey denni furguson ftpdf mark riordan ftpmr phil karn ftppk a pascal list of de be also give in patterson fip say the algorithm specify in thi standard be to be implement use hardware not software technology software implementation in general purpose computer be not in compliance with thi standard despite thi software implementation abound and be use by government agency is de available in hardware the follow paragraph be quote from message send to the editor we do vouch for the quality or even existence of the product chip rosenthal say dalla semiconductor make a de device for use on standard digital pcm telecom datum stream it be capable of process datum in real time one it be the their phone number be you would probably need to talk with dewight in telecom market christian franke franke say cryptech accord to datum sheet with bit interface we use thi one because it wa the only one available when we start the project no problem pijnenburg accord to datum sheet addres pijnenburg boxtelswweg ne vught the netherland infosy de chip germany s-box must be load by software so you can modify the algorithm sorry i do have the datum sheet handy please e-mail me if you need further information mjr marcu j ranum say supercrypt and faster de and proprietary storage for key key stream generator integrated hardware procedure extended mode with bite key computer elektronik infosy herndon parkway herndon va thember tim hember say newbridge microsystem sell an compatible de chip that operate at perform a round of encryption in clock ha a three-stage pipeline support ecb cbc and further it be very reasonable price a oppose to other high-end de chip call newbridge microsystem ottawa there be no issue with canada and the u if you require custom de or public key ics then timestep engineering develop newbridge crypto chip and ics for other commercial and educational establishment they can be reach at can de be use to protect classify information de be not intend to protect classify datum fip say thi standard will be use by federal department and agency for the cryptographic protection of computer datum when the follow condition apply cryptographic protection be require and the datum be not classify accord to the national security act of a amend or the atomic energy act of a amend what be ecb cbc cfb and ofb encryption these be method for use block cipher such a de to encrypt message file and block of datum know a mode of operation fmy mode of operation be define in fip december and also in ansi fip specify that when ascius datum be send in octet the unused most-significant bite be to be set to fip also specify the pad for short block the fmy de mode of operation be electronic code book ecb cipher block chaining cbc k-bit cipher feedback cfb and k-bit output feedback ofb these method be explain below in a c-language-like notation some symbol p n the block of plaintext input to encryption output from decryption size of block determine by the mode c n the block of ciphertext output from encryption input to decryption size of block determine by the mode e m the de encryption function perform on block m use the schedule derive from some key d m the de decryption function perform on block m use the same key schedule a in e m except that the key in the schedule be use in the opposite order a in e m iv a initialization vector a secret value which along with the key be share by both encryptor and decryptor i n the value of a variable use in some mode r n the value of a variable use in some mode lsb m k the k least significant right-most bite of m m k msb m k the k most significant left-most bite of m m k operator a define in the c langage electronic code book ecb p n and c n be each long encryption decryption c n e p n p n d c n cipher block chaining cbc p n and c n be each long encryption decryption c e p iv p d c iv n c n e p n c p n d c n c k-bit cipher feedback cfb p n and c n be each k bite long k encryption decryption i iv i iv n i n i k c i n i k c all n r n msb e i n k r n msb e i n k all n c n p n r n p n c n r n note that for thi reduce to i iv i iv n i n c i n c all n r n e i n r n e i n all n c n p n r n p n c n r n cfb note since i n depend only on the plain or cipher text from the previou operation the e function can be perform in parallel with the reception of the text with which it be use k-bit output feedback ofb p n and c n be each k bite long k encryption decryption i iv i iv n i n i k r i n i k r all n r n msb e i n k r n msb e i n k all n c n p n r n p n c n r n note that for thi reduce to i iv i iv n i n r i n r all n r n e i n r n e i n all n c n p n r n p n c n r n ofb note encryption and decryption be identical since i n be independent of p and c the e function can be perform in advance of the receipt of the text with which it be to be use additional note on de mode of operation ecb and cbc use e to encrypt and d to decrypt but the feedback mode use e to both encrypt and decrypt thi disprove the erroneou claim that system which feature e but not d can not be use for datum confidentiality and therefore be not subject to export control 